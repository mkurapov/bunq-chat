(this["webpackJsonpbunq-chat"]=this["webpackJsonpbunq-chat"]||[]).push([[0],[,,,,,,function(e,t,n){e.exports=n(13)},,,,,function(e,t,n){},function(e,t,n){e.exports=n.p+"static/media/logo.eb9aa403.png"},function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(4),s=n.n(c),o=(n(11),n(1)),l=n(5),i=n(2),u="http://assignment.bunq.com",m=2232,f=["#6f42c1","#007bff","#28a745","#dc3545","#FFC107"];function d(e){var t=Object(a.useContext)(O).allUsers,n=e.userId,c=t.find((function(e){return e.id===n})).name,s=f[n-1]?f[n-1]:"black";return r.a.createElement("span",{className:"avatar",style:{backgroundColor:s}},c[0])}function v(e){var t=Object(a.useContext)(O).user,n=e.msg;return n.senderId===t.id?r.a.createElement("div",{className:"message-wrap"},r.a.createElement("span",{className:"message message--sender",key:n.id},n.message)):r.a.createElement("div",{className:"message-wrap"},r.a.createElement("div",{className:"message__avatar"},r.a.createElement(d,{userId:n.senderId})),r.a.createElement("span",{className:"message",key:n.id},n.message))}function b(){window.scrollTo(0,document.body.scrollHeight)}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(n,!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h=function(){var e=Object(a.useState)([]),t=Object(o.a)(e,2),n=t[0],c=t[1],s=Object(a.useState)(""),l=Object(o.a)(s,2),f=l[0],g=l[1],h=Object(a.useState)(""),p=Object(o.a)(h,2),j=p[0],_=p[1],N=Object(a.useContext)(O).user;return Object(a.useEffect)((function(){fetch("".concat(u,"/conversation/").concat(m,"/message/limited?limit=10&offset=0")).then((function(e){return e.json()})).then((function(e){if(e.length>0){var t=e.sort((function(e,t){return e.id-t.id}));_(t[t.length-1].id),c(t),b()}}))}),[]),Object(a.useEffect)((function(){var e=setInterval((function(){j&&fetch("".concat(u,"/conversation/").concat(m,"/new/").concat(j)).then((function(e){return e.json()})).then((function(e){e.length>0&&(c((function(t){return[].concat(Object(i.a)(t),Object(i.a)(e))})),_(e[e.length-1].id),b())})).catch((function(){console.error("UNABLE TO GET NEW MESSAGES")}))}),3e3);return function(){return clearInterval(e)}}),[j]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"nav"},r.a.createElement("div",{className:"nav__inner"},r.a.createElement("div",null,"Bunq Chat"),r.a.createElement("div",{className:"nav__avatar"},r.a.createElement(d,{userId:N.id})))),r.a.createElement("div",{className:"chat"},r.a.createElement("form",{className:"chat__form",onSubmit:function(e){return function(e){if(e.preventDefault(),f){var t={message:f,senderId:N.id};g("");var a="".concat(u,"/conversation/").concat(m,"/message/send");fetch(a,{method:"POST",body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){_(e.id),c([].concat(Object(i.a)(n),[E({},t,{id:e.id})])),b()}))}}(e)}},r.a.createElement("input",{className:"chat__form__input",type:"text",value:f,onChange:function(e){return g(e.target.value)}}),r.a.createElement("input",{className:"chat__form__btn",type:"submit",value:"Submit"})),n&&N?n.map((function(e,t){return r.a.createElement(v,{key:e.id,msg:e})})):null))};var p=function(){var e=Object(a.useContext)(O),t=e.setUser,c=e.allUsers,s=e.setAllUsers;function o(e){return f[e.id-1]?f[e.id-1]:"black"}return Object(a.useEffect)((function(){fetch("".concat(u,"/users")).then((function(e){return e.json()})).then((function(e){s(e)}))}),[]),r.a.createElement("div",null,r.a.createElement("div",{className:"login__title"},"Welcome to bunq chat!"),r.a.createElement("div",{className:"login__subtitle"},"Please select a user"),r.a.createElement("div",{className:"login"},c.map((function(e,n){return r.a.createElement("div",{className:"login__user",key:n,onClick:function(){return t(e)}},r.a.createElement("div",{className:"login__avatar",style:{backgroundColor:o(e)}}),r.a.createElement("span",{className:"login__name"},e.name))}))),r.a.createElement("div",{className:"footer"},r.a.createElement("img",{className:"footer__logo",src:n(12)})))},O=r.a.createContext();Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement((function(){var e=Object(a.useState)(null),t=Object(o.a)(e,2),n=t[0],c=t[1],s=Object(a.useState)([]),l=Object(o.a)(s,2),i=l[0],u=l[1];return r.a.createElement(O.Provider,{value:{user:n,setUser:c,allUsers:i,setAllUsers:u}},r.a.createElement("div",{className:"banner"}),n?r.a.createElement(h,null):r.a.createElement(p,null))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}],[[6,1,2]]]);
//# sourceMappingURL=main.6f1ce4eb.chunk.js.map